---
title: "q1.5"
output: html_document
---

We call the necessary packages as below:
```{r setup, include=FALSE}
library(readr)
library(forecast)
library(xts)
getwd()
library(dplyr)
library(fpp)
library(fpp3)
library(gridExtra)
library(ggplot2)
library(ranger)
library(ftsa)
library(Metrics)
library(smooth)
library(Mcomp)
library(rmarkdown)
library(fable)
```

The first step is to read the data in a .csv file and convert them to a time series object.

#Step 1 read the csv datasets files
```{r}
data = read.csv("/Users/Bryan/Google Drive/Cours/DSBA/T1/1. Forecasting & Predictive Analysis/6. Project/Projectdata.csv")
tsdata <- xts(data[,2:19], as.Date(data$date))
```

We also read the data to set-up the SARIMAX method
```{r}
Tempdata <- read.csv("/Users/Bryan/Downloads/California_temp_max_min.csv")
tstemp <- xts(Tempdata[,2:3],as.Date(data$date))
tstemp_weekly = apply.weekly(tstemp, sum)
```


Then, we aggregate the data on a weekly basis
#Step 2 Aggregate the data by week
```{r}
weekly = apply.weekly(tsdata[,1:18], sum)

weekly = apply.weekly(tsdata, function(d){
  c(Hobbies_CA_1 = sum(d$Hobbies_CA_1),
    Hobbies_CA_2 = sum(d$Hobbies_CA_2),
    Hobbies_CA_3 = sum(d$Hobbies_CA_3),
    Household_1_CA_1 = sum(d$Household_1_CA_1),
    Household_1_CA_2 = sum(d$Household_1_CA_2),
    Household_1_CA_3 = sum(d$Household_1_CA_3),
    Household_2_CA_1 = sum(d$Household_2_CA_1),
    Household_2_CA_2 = sum(d$Household_2_CA_2),
    Household_2_CA_3 = sum(d$Household_2_CA_3),
    Foods_1_CA_1 = sum(d$Foods_1_CA_1),
    Foods_1_CA_2 = sum(d$Foods_1_CA_2),
    Foods_1_CA_3 = sum(d$Foods_1_CA_3),
    Foods_2_CA_1 = sum(d$Foods_2_CA_1),
    Foods_2_CA_2 = sum(d$Foods_2_CA_2),
    Foods_2_CA_3 = sum(d$Foods_2_CA_3),
    Foods_3_CA_1 = sum(d$Foods_3_CA_1),
    Foods_3_CA_2 = sum(d$Foods_3_CA_2),
    Foods_3_CA_3 = sum(d$Foods_3_CA_3)
    )
})

```

As for the previous questions, we split the time series in three different splits:
- 70-30
- 80-20
- 90-10
#Step 3 perform training and testing data split
split: 70-30
```{r 70-30}
train1 <- head(weekly, 198)
test1 <- tail(weekly, 84)
```

split: 80-20
```{r 80-20}
train2 <- head(weekly, 226)
test2 <- tail(weekly, 56)
```

split: 90-10
```{r}
train3 <- head(weekly, 254)
test3 <- tail(weekly, 28)
```

We implement the necessary functions to perform our benchmarks
```{r}
#Naive
Naive <- function(x, h, type){
  frcst <- rep(tail(x,1), h)
  if (type=="seasonal"){
    frcst <- head(rep(as.numeric(tail(x,7)), h), h) 
  }
  return(frcst)
}


#sNaive
sNaive <- function(x, h){
  frcst <- head(rep(as.numeric(tail(x,7)), h), h) 
  return(frcst)
}


#ES
ES <- function(a, x, h, job){
  y <- c()  
  y[1] <- x[1] #initialization
  
  for (t in 1:(length(x))){
    y[t+1] <- a*x[t]+(1-a)*y[t]
  }
  
  fitted <- head(y,(length(y)-1))
  forecast <- rep(tail(y,1),h)
  if (job=="train"){
    return(mean((fitted - x)^2))
  }else if (job=="fit"){
    return(fitted)
  }else{
    return(list(fitted=fitted,mean=forecast))
  }
}


#MA
MA <- function(x, h){
  mse <- c()
  for (k in 2:14){
    y <- rep(NA, k)
    for (i in (k+1):length(x)){
      y <- c(y, mean(x[(i-k):(i-1)]))
    }
    mse <- c(mse, mean((y-x)^2, na.rm = T))
  }
  k <- which.min(mse)+1
  forecast <- rep(mean(as.numeric(tail(x, k))), h)
  return(forecast)
}
```

For each product, we compute a series of key statistics to assess the accuracy of the forecast methods. The choice of the best method is based on the RMSE statistics.

Let's analyze the forecast for the Hobbies products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Hobbies_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Hobbies_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Hobbies_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Hobbies_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Hobbies_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Hobbies_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is sNaive.


[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Hobbies_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Hobbies_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Hobbies_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Hobbies_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Hobbies_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Hobbies_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate methods is ES.


[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Hobbies_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Hobbies_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Hobbies_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Hobbies_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Hobbies_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Hobbies_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Hobbies_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Household_1 products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Household_1 products
[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Household_1 products
[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Household_2 products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Household_2 products
[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Household_2 products
[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Household_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Household_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Household_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Household_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Household_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Household_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Household_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Household_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Foods_1 products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_1 products
[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Foods_1 products
[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is SARIMA.


Foods_2 products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_2 products
[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method are ARIMA and SARIMA.


Foods_2 products
[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Foods_3 products
[Store 1 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_3_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_3_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_3_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_3_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_3_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_3_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_3 products
[Store 2 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_3_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_3_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_3_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_3_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_3_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_3_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Foods_3 products
[Store 3 - Train Split 1]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train1$Foods_3_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train1$Foods_3_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train1$Foods_3_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train1$Foods_3_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train1$Foods_3_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train1$Foods_3_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test1$Foods_3_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is SARIMA.


###SPLIT 2

[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Hobbies_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Hobbies_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Hobbies_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Hobbies_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Hobbies_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Hobbies_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is sNaive.


[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Hobbies_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Hobbies_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Hobbies_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Hobbies_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Hobbies_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Hobbies_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate methods is ARIMA


[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Hobbies_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Hobbies_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Hobbies_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Hobbies_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Hobbies_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Hobbies_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Hobbies_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Household_1 products
[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is SARIMA.


Household_1 products
[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Household_1 products
[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is sNaive.


Household_2 products
[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Household_2 products
[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Household_2 products
[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Household_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Household_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Household_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Household_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Household_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Household_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Household_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Household_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA


Foods_1 products
[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ES.


Foods_1 products
[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is sNaive.


Foods_1 products
[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_2 products
[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Foods_2 products
[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method are sNAive.


Foods_2 products
[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method are ARIMA and SARIMA.


Foods_3 products
[Store 1 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_3_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_3_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_3_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_3_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_3_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_3_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is SARIMA.


Foods_3 products
[Store 2 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_3_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_3_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_3_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_3_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_3_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_3_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Foods_3 products
[Store 3 - Train Split 2]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train2$Foods_3_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train2$Foods_3_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train2$Foods_3_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train2$Foods_3_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train2$Foods_3_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train2$Foods_3_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test2$Foods_3_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is SARIMA.



###SPLIT 3

[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Hobbies_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Hobbies_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Hobbies_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Hobbies_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Hobbies_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Hobbies_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Hobbies_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Hobbies_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Hobbies_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Hobbies_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Hobbies_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Hobbies_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate methods is MA.


[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Hobbies_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Hobbies_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Hobbies_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Hobbies_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Hobbies_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Hobbies_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Hobbies_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Household_1 products
[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Household_1 products
[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is sNaive.


Household_1 products
[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Household_2 products
[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ES.


Household_2 products
[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ES.


Household_2 products
[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Household_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Household_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Household_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Household_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Household_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Household_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Household_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Household_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_1 products
[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_1_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_1_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_1_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_1_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_1_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_1_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_1 products
[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_1_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_1_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_1_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_1_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_1_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_1_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is MA.


Foods_1 products
[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_1_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_1_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_1_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_1_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_1_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_1_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_1_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA.


Foods_2 products
[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_2_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_2_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_2_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_2_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_2_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_2_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Naive.


Foods_2 products
[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_2_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_2_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_2_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_2_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_2_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_2_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method are Holt-Winters.


Foods_2 products
[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_2_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_2_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_2_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_2_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_2_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_2_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_2_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method are Holt-Winters.


Foods_3 products
[Store 1 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_1, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_1, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_3_CA_1, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_3_CA_1, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_3_CA_1, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_3_CA_1,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_3_CA_1, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_3_CA_1, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.


Foods_3 products
[Store 2 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_2, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_2, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_3_CA_2, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_3_CA_2, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_3_CA_2, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_3_CA_2,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_3_CA_2, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_3_CA_2, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is ARIMA and SARIMA.


Foods_3 products
[Store 3 - Train Split 3]
```{r}
Methods <- NULL
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_3, 4, type="simple"))
Methods <- cbind(Methods, Naive(train3$Foods_3_CA_3, 4, type="seasonal"))
Methods <- cbind(Methods, MA(train3$Foods_3_CA_3, 4))
Methods <- cbind(Methods, as.numeric(es(ts(train3$Foods_3_CA_3, frequency = 7), h=4)$forecast))
Methods <- cbind(Methods, forecast::forecast(auto.arima(ts(train3$Foods_3_CA_3, frequency = 4)), h=4)$mean)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(auto.arima(train3$Foods_3_CA_3,D=1,seasonal=TRUE), h=4))$`Point Forecast`)
Methods <- cbind(Methods, as.data.frame(forecast::forecast(HoltWinters(train3$Foods_3_CA_3, gamma = FALSE), h=4))$`Point Forecast`)

colnames(Methods) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")

actuals = as.numeric(head(test3$Foods_3_CA_3, 4))

# initialization of an empty dataframe to store the accuracy results
mat = matrix(ncol = 7, nrow =4)
df_res = data.frame(mat)

names(df_res) = c("Naive", "sNaive", "MA", "ES", "ARIMA", "SARIMA", "Holt-Winters")
rownames(df_res) <- c("MAE","MAPE", "MSE", "RMSE")

for (i in 1:length(colnames(Methods))){
  df_res[1,i] = mae(actuals, Methods[,i])
  df_res[2,i] = mape(actuals, Methods[,i])
  df_res[3,i] = mse(actuals, Methods[,i])
  df_res[4,i] = rmse(actuals, Methods[,i])
}

df_res
```
According to the results, the most accurate method is Holt-Winters.



